<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />

        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title></title>


        <link rel="stylesheet" href="./libs/jquery.mobile-1.2.0.min.css" />

	<!-- Custom css -->
        <!-- <link rel="stylesheet" href="my.css" />-->

	<!-- Custom css ICONS-->
	<link rel="stylesheet" href="./libs/jqm-icon-pack-3.0.0-fa.css" />



        <script src="./libs/jquery.min.js">
        </script>

        <script src="./js/main.js">
        </script>


<!-- User-generated css -->
<style>

	#rootpage {
	/*width: 100%; height: 100%;*/ padding: 0;
	}
	#rootpageContent {
	/*width: 100%; height: 100%;*/ padding: 0;
	}
	#map_canvas { 
	/*height:100%; min-height: 100%;*/
	}  


	@media only screen and (-webkit-min-device-pixel-ratio: 2) {
		.ui-icon-gpsb {
			background-image: url(./img/gpsb_w_hd.png) !important;
			background-size: 18px 18px;
		}
	}


	.ui-slider-input {
		display : none !important;
	}


	.ui-slider {
		width:95% !important;
	}


	.nav-glyphish-example .ui-btn .ui-btn-inner .ui-icon-custom { padding-top: 25px !important; }
	.nav-glyphish-example .ui-btn .ui-icon { width: 25px!important; height: 25px!important; margin-left: -15px !important; box-shadow: none!important; -moz-box-shadow: none!important; -webkit-box-shadow: none!important; -webkit-border-radius: 0 !important; border-radius: 0 !important; }
	#gpsi .ui-icon { background:  url(custom_icons/gpsi.png) 50% 50% no-repeat; background-size: 25px 25px; opacity: 0.7;}
	#searchi .ui-icon { background:  url(custom_icons/searchi.png) 50% 50% no-repeat; background-size: 24px 24px; opacity: 0.7;}
	#sharei .ui-icon { background:  url(custom_icons/sharei.png) 50% 50% no-repeat;  background-size: 22px 22px; opacity: 0.7;}




	#popupPanel-popup {

	    left: 0 !important;
	    bottom: auto !important;
	}
	#popupPanel {

	    width: 200px;
	    border: 1px solid #000;
	    border-right: none;
	    background: rgba(0,0,0,.5);
	    margin: -1px 0;
	}
	#searchfield{
	    margin-left:30px;
	    width:80% !important;
	    bottom:0px !important;
	    position:absolute !important;

	}

.ui-page { -webkit-backface-visibility: hidden; } /*workaround Android http://jquerymobile.com/demos/1.2.0/docs/pages/page-transitions.html*/


#root_footer {
padding-top: 20px;
padding-bottom: 10px;
}


</style>



	<!-- cordova-->
        <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>

<!-- User-generated js -->
<script>

    // Wait for Cordova to load
    // 
function onLoad() {
    // the next line makes it impossible to see Contacts on the HTC Evo since it
    // doesn't have a scroll button
    // document.addEventListener("touchmove", preventBehavior, false);
    document.addEventListener("deviceready", onDeviceReady, false);


}

    // Cordova is loaded and it is now safe to make calls Cordova methods
    //
    function onDeviceReady() {
	//navigator.splashscreen.hide();
 navigator.notification.alert("PhoneGap is working!!");
        //checkConnection();
	//document.addEventListener("offline", onOffline, false);
	//document.addEventListener("online", onOnline, false);

    }

    function onOffline() {

	alert("You are offline. No Internet connection found.");
    }

    function online() {
	alert("You are online.");
    }



    function checkConnection() {
        var networkState = navigator.network.connection.type;

        var states = {};
        states[Connection.UNKNOWN]  = 'Unknown connection';
        states[Connection.ETHERNET] = 'Ethernet connection';
        states[Connection.WIFI]     = 'WiFi connection';
        states[Connection.CELL_2G]  = 'Cell 2G connection';
        states[Connection.CELL_3G]  = 'Cell 3G connection';
        states[Connection.CELL_4G]  = 'Cell 4G connection';
        states[Connection.NONE]     = 'No network connection';

        alert('Connection type: ' + states[networkState]);
    }




$(document).bind("mobileinit", function(){
    $.mobile.page.prototype.options.domCache = false;
});


var onceBH = true;


			$("#rootpage").live("pageshow", function() {

				var bannerH = 0;
				if(onceBH) {
					bannerH = 50 * window.devicePixelRatio ;
					onceBH =false;
				}

				var h_window = $(window).height();

				var root_footer = $('#root_footer').outerHeight(true);
				var root_header = $('#root_header').outerHeight(true);
				var h_map = h_window - bannerH - root_footer - root_header;

				$('#map_canvas').css('height', h_map);
				$('#map_canvas').css('min-height', h_map);
				var divAnchor = root_header + root_header;
				$('#divAnchor').css('top', divAnchor);
			});



			$(document).delegate("#rootpage", "pageinit", function() {  

				window.onload = MainJS.loadmap;

				$('#sharei').bind("click", function() {
					if(markersArray.length==0) {
						alert("You must have a location first.")
						return false;
					} else {
						$("#sharei").prop("href", "#locationinfo");
					}
				});



				$('#search_form').bind("submit", function() {
					MainJS.codeAddress($('#search_location').val());
					$( "#popupPanel" ).popup( "close" );
					return false;
				});


				$( "#popupPanel" ).bind({
					popupbeforeposition: function() {
						var root_header = $('#root_header').outerHeight(true);
						var h_popup = root_header + root_header;
						$( "#popupPanel" ).css( "height",h_popup);
						var w = $( window ).width();
						$( "#popupPanel" ).css( "width", w );

					},
					popupafteropen: function() {
						$( "#search_location" ).focus();
					}
				});



				$('#switch-b').on("slidestop", function() {
					var selectVal = $('#switch-b :selected').val();
					MainJS.swtichmap(selectVal);
					
					
				});

				$('#slider-2').bind("change", function() {
					var selectVal = $('#slider-2').val();
					map.setZoom(parseInt(selectVal));
				});

				$('#gpsi').bind("click", function() {
					$.mobile.loading( 'show', {
							text: 'Waiting for GPS signal',
							textVisible: true,
							theme: 'a',
							textonly: false
					});
					var options ={ /*maximumAge: 3000, timeout: 5000,*/ enableHighAccuracy: true };
					watchID = navigator.geolocation.watchPosition(MainJS.GPSonSuccess, MainJS.GPSonError, options);
					return false;
				});


		}); //function maptiler.setOpacity(0.4); - add latter?





		$(document).delegate('#resetForm', 'click', function() {
				$('#TitleShare').val('');
				$('#DescriptionShare').val('');
		});


		$(document).delegate('#save', 'click', function() {
			MainJS.Save($("#TitleShare").val(), $('#DescriptionShare').val(), ""/*link*/, ""/*anchor*/, $('#optionAddress').is(':checked'), $('#optionLatLon').is(':checked'));
		});

		$(document).delegate('#skipForm', 'click', function() {
			MainJS.Save("", "", ""/*link*/, ""/*anchor*/, $('#optionAddress').is(':checked'), $('#optionLatLon').is(':checked'));
		});

		$("#sharepage").live("pageshow", function() {

			$('#shorturl').val(shortURL);
		});

		$(document).delegate('#browserLink', 'click', function() {
			navigator.app.loadUrl(shortURL, {openExternal: true});
		});

		$(document).delegate('#backMap', 'click', function() {
			MainJS.clearBack();
		});

		$(document).delegate('#smsLink', 'click', function() {
			navigator.app.loadUrl("sms:?body=" + shareText, {openExternal: true});
		});

		$(document).delegate('#emailLink', 'click', function() {
			navigator.app.loadUrl("mailto:?subject=Location&body=" + shareText, {openExternal: true});
		});

		$(document).delegate('#twitterLink', 'click', function() {
			navigator.app.loadUrl("http://twitter.com/share?text=" + shareText, {openExternal: true});
		});

		$(document).delegate('#facebookLink', 'click', function() {
			navigator.app.loadUrl("http://www.facebook.com/sharer.php?u=" + shareText, {openExternal: true});
		});

</script>



        <script src="./libs/jquery.mobile-1.2.0.min.js">
        </script>


</head>
<body onload="onLoad()">
	<!-- rootpage -->
	<div data-role="page" id="rootpage">
		<div data-theme="a" data-role="header" id="root_header" class="nav-glyphish-example">
			<div data-role="navbar" class="nav-glyphish-example" >
				<ul>
					<li><a href="" id="gpsi" data-icon="custom"></a></li>
					<li><a href="#popupPanel" data-rel="popup" data-transition="slidedown" id="searchi" data-icon="custom" data-position-to="#divAnchor"></a></li>
					<li><a href="" data-transition="slide" id="sharei" data-icon="custom"></a></li>
				</ul>
			</div><!-- /navbar -->


			<div data-role="popup" id="popupPanel" data-corners="false" data-theme="none" ata-dismissible="true" data-shadow="false" data-tolerance="0,0">
				<form id="search_form">
					<div data-role="fieldcontain" id="searchfield">
							<input name="" id="search_location" placeholder="Search a location..." value="" type="search"  data-inline="true" data-mini="true" data-theme="a"/>
					</div>
				</form>
			</div>

		</div><!-- root_header -->

		<div data-role="content" id="rootpageContent">
			<div id="divAnchor" style="position:absolute;"></div>
			<div id="map_canvas"></div>

		</div>

		<div data-role="footer" id="root_footer">
			<table>
				<tr>
				<td width="100px">
					<select name="switch-b" id="switch-b" data-role="slider" data-inline="true" data-mini="true">
						<option value="0">Off</option>
						<option value="1">On</option>
					</select> 
				</td>

				<td width="600px">
					<input type="range" name="slider-2" id="slider-2" value="3" min="2" max="17" data-theme="a" data-track-theme="b"/>
				</td>
				</tr>

			</table>




		</div>

	</div> <!-- /rootpage -->

	<!-- Start of second page -->
	<div data-role="page" id="locationinfo"  data-theme="a">

		<div data-role="header">
			<a href="#rootpage" data-icon="back" data-theme="b" data-transition="slide" data-direction="reverse">Back</a>
			<h1>Additional Information</h1>
			<a href="" data-theme="b" data-iconpos="right" id="skipForm" data-transition="slide" data-icon="forward">Skip</a>
		</div>

		<div data-role="content">	
			<p>Add additional information for this location. None of the fields are mandatory.</p>		

			<div data-role="fieldcontain">
				<label for="TitleShare">Title:</label>
				<input type="text" name="TitleShare" id="TitleShare" value="" placeholder="Type a title.." maxlength="70"/>
			</div>

			<div data-role="fieldcontain">
				<label for="DescriptionShare">Description:</label>
				<textarea  rows="4" name="DescriptionShare" id="DescriptionShare"  placeholder="Type a description.." maxlength="256"></textarea>
			</div>


			<div data-role="fieldcontain">
				<fieldset data-role="controlgroup">

				<legend>Select Link Text:</legend>
				<input type="checkbox" name="checkbox-1a" id="optionAddress" class="custom" checked/>
				<label for="optionAddress">Show Address</label>

				<input type="checkbox" name="checkbox-2a" id="optionLatLon" class="custom" checked/>
				<label for="optionLatLon">Show Location</label>

				</fieldset>
			</div>

			<fieldset class="ui-grid-a">
				<div class="ui-block-a"><button data-icon="delete" id="resetForm" data-theme="d">Reset</button></div>
				<div class="ui-block-b"><button type="submit" id="save" data-theme="b" data-icon="arrow-r" data-iconpos="right">Submit</button></div>
			</fieldset>

		</div><!-- /content -->

		<div data-role="footer">
			<h4></h4>
		</div><!-- /footer -->
	</div><!-- /locationinfo -->


	<!-- Start of sharepage page -->
	<div data-role="page" id="sharepage"  data-theme="a">

		<div data-role="header">
			<h1>Share</h1>
			<a href=""  data-icon="map-marker" data-theme="b" class="ui-btn-right" id="backMap">Map</a>
		</div>

		<div data-role="content">
			<label for="shorturl">Your short URL:</label>
			<input type="text" name="shorturl" id="shorturl" value=""  />
			<a href="" data-role="button" data-icon="globe" data-iconpos="right" rel="external" target="_blank" id="browserLink">Open in a Browser</a>
			<a href="" data-role="button" data-icon="comment" data-iconpos="right" id="smsLink">Send to SMS</a>
			<a href="" data-role="button" data-icon="envelope-alt" data-iconpos="right" id="emailLink">Send to Email</a>
			<a href="" data-role="button" data-icon="twitter" data-iconpos="right" rel="external" id="twitterLink">Share This on Twitter</a>
			<a href="" data-role="button" data-icon="facebook" data-iconpos="right" data-rel="dialog" id="facebookLink">Share to Facebook</a>

		</div><!-- /content -->

		<div data-role="footer">
			<h4></h4>
		</div><!-- /footer -->

	</div><!-- sharepage-->

</body>
</html>
